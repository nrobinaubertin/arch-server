#!/bin/sh

# TODO
# use colors effectively
# enhance display of storage
# remove fortune ?

# Text Reset
RCol='\033[0m'    

# Regular                              
Bla='\033[0;30m';                      
Red='\033[0;31m';                      
Gre='\033[0;32m';                      
Yel='\033[0;33m';                      
Blu='\033[0;34m';                      
Pur='\033[0;35m';                      
Cya='\033[0;36m';                      
Whi='\033[0;37m';                      

#Bold              
BBla='\033[1;30m';
BRed='\033[1;31m';
BGre='\033[1;32m';
BYel='\033[1;33m';
BBlu='\033[1;34m';
BPur='\033[1;35m';
BCya='\033[1;36m';
BWhi='\033[1;37m';

#Underline         
UBla='\033[4;30m';
URed='\033[4;31m';
UGre='\033[4;32m';
UYel='\033[4;33m';
UBlu='\033[4;34m';
UPur='\033[4;35m';
UCya='\033[4;36m';
UWhi='\033[4;37m';

#High Intensity    
IBla='\033[0;90m';
IRed='\033[0;91m';
IGre='\033[0;92m';
IYel='\033[0;93m';
IBlu='\033[0;94m';
IPur='\033[0;95m';
ICya='\033[0;96m';
IWhi='\033[0;97m';

#BoldHigh Intens    
BIBla='\033[1;90m';
BIRed='\033[1;91m';
BIGre='\033[1;92m';
BIYel='\033[1;93m';
BIBlu='\033[1;94m';
BIPur='\033[1;95m';
BICya='\033[1;96m';
BIWhi='\033[1;97m';

#Background        
On_Bla='\033[40m';
On_Red='\033[41m';
On_Gre='\033[42m';
On_Yel='\033[43m';
On_Blu='\033[44m';
On_Pur='\033[45m';
On_Cya='\033[46m';
On_Whi='\033[47m';

#High Intensity Backgrounds
On_IBla='\033[0;100m';
On_IRed='\033[0;101m';
On_IGre='\033[0;102m';
On_IYel='\033[0;103m';
On_IBlu='\033[0;104m';
On_IPur='\033[0;105m';
On_ICya='\033[0;106m';
On_IWhi='\033[0;107m';

echo "----------"
echo `date`
if [[ -n $(which fortune) ]]
then
	fortune -sn 70
fi

# details
echo -n "-"
machine=$(</proc/sys/kernel/hostname)
echo -n "-"
arch=$(uname -m)
echo -n "-"
mykernel=$(uname -r)
echo -n "-"
mycpu=$(grep -m1 "model name" /proc/cpuinfo | cut -d':' -f2 | sed -r 's/(Intel\(R\)|CPU|@|\s+)/ /g' | sed -r 's/\s+/ /g' | sed -r 's/^\s+//')
echo -n "-"
myshell=$(ps -p `ps -p $$ -o ppid=` | sed -n '2p' | sed -r 's/.*\s(.*)$/\1/')
echo -n "-"
mymem=$(free -h --si | sed -n '2p' | sed -r 's/\s+/ /g' | cut -d' ' -f2)
echo -n "-"
myip=$(ip route show | tail -n1 | sed -r 's/.*src(.*)/\1/' | cut -d' ' -f2)
echo -n "-"
#mypackages=$(pacman -Qet | wc -l)
#echo -n "-"
myterm=$(echo $TERM)
echo -n "-"

# get uptime
ups=$(cat /proc/uptime | cut -d. -f1)
echo -n "-"
upm=$(( $ups / 60 ))
uph=$(( $upm / 60 ))
upd=$(( $uph / 24 ))
if [ "$upm" != 0 ]; then ups=$(( $ups - $upm*60 )); fi
if [ "$uph" != 0 ]; then upm=$(( $upm - $uph*60 )); fi
if [ "$upd" != 0 ]; then uph=$(( $uph - $upd*24 )); fi
if [ "$ups" -lt 10 ]; then ups=$( echo "0$ups"); fi
if [ "$upm" -lt 10 ]; then upm=$( echo "0$upm"); fi
if [ "$uph" -lt 10 ]; then uph=$( echo "0$uph"); fi

if [ "$upd" != 0 ]
then
	if [ "$upd" <= 9 ]
	then
		myuptime=$(echo "$upd day, $uph:$upm:$ups")
	else
		myuptime=$(echo "$upd days, $uph:$upm:$ups")
	fi
else
	myuptime=$(echo "$uph:$upm:$ups")
fi


########

mydev1_data=$(df -h | grep -E "^/dev/" | sed -n "1p" | sed -r 's/\s+/ /g')
mydev2_data=$(df -h | grep -E "^/dev/" | sed -n "2p" | sed -r 's/\s+/ /g')
mydev3_data=$(df -h | grep -E "^/dev/" | sed -n "3p" | sed -r 's/\s+/ /g')
mydev4_data=$(df -h | grep -E "^/dev/" | sed -n "4p" | sed -r 's/\s+/ /g')

mydev1_name=$(echo $mydev1_data | cut -d' ' -f1)
mydev2_name=$(echo $mydev2_data | cut -d' ' -f1)
mydev3_name=$(echo $mydev3_data | cut -d' ' -f1)
mydev4_name=$(echo $mydev4_data | cut -d' ' -f1)

mydev1_avail=$(echo $mydev1_data | cut -d' ' -f4)
mydev2_avail=$(echo $mydev2_data | cut -d' ' -f4)
mydev3_avail=$(echo $mydev3_data | cut -d' ' -f4)
mydev4_avail=$(echo $mydev4_data | cut -d' ' -f4)

mydev1_size=$(echo $mydev1_data | cut -d' ' -f2)
mydev2_size=$(echo $mydev2_data | cut -d' ' -f2)
mydev3_size=$(echo $mydev3_data | cut -d' ' -f2)
mydev4_size=$(echo $mydev4_data | cut -d' ' -f2)

if [[ $mydev1_name != '' ]]
then
	#mydev1=$(echo "$mydev1_name \t$mydev1_avail \t(used : $mydev1_percent)")
	mydev1=$(echo "$mydev1_name $mydev1_avail / $mydev1_size")
fi
if [[ $mydev2_name != '' ]]
then
	#mydev2=$(echo "$mydev2_name \t$mydev2_avail \t(used : $mydev2_percent)")
	mydev2=$(echo "$mydev2_name $mydev2_avail / $mydev2_size")
fi
if [[ $mydev3_name != '' ]]
then
	#mydev3=$(echo "$mydev3_name \t$mydev3_avail \t(used : $mydev3_percent)")
	mydev3=$(echo "$mydev3_name $mydev3_avail / $mydev3_size")
fi
if [[ $mydev4_name != '' ]]
then
	#mydev4=$(echo "$mydev4_name \t$mydev4_avail \t(used : $mydev4_percent)")
	mydev4=$(echo "$mydev4_name $mydev4_avail / $mydev4_size")
fi

echo -e "${Cya}
                ._,.
          '..-..pf.
         -L   ..#'
       .+_L  .']#
       ,'j' .+.j'                 -'.__..,.,p. ${BGre}Machine:${RCol} ${machine}${Cya}
      _~ #..<..0.                 .J-.''..._f. ${BGre}Architecture:${RCol} ${arch}${Cya}
     .7..#_.. _f.                .....-..,'4'  ${BGre}Kernel:${RCol} ${mykernel}${Cya}
     ;' ,#j.  T'      ..         ..J....,'.j'  ${BGre}CPU:${RCol} ${mycpu}${Cya}
    .' ..'^.,-0.,,,,yMMMMM,.    ,-.J...+'.j@   ${BGre}Memory:${RCol} ${mymem}${Cya}
   .'.'...' .yMMMMM0M@^='''g.. .'..J..'.'.jH   ${BGre}Uptime:${RCol} ${myuptime}${Cya}
   j' .'1'  q'^)@@#'^'.''='BNg_...,]_)'...0-   ${BGre}Shell:${RCol} ${myshell}${Cya}
  .T ...I. j'    .'..+,_.'3#MMM0MggCBf....F.   ${BGre}Terminal:${RCol} ${myterm}${Cya}
  j/.+'.{..+       '^~'-^~~''''''''?'''''1'    ${BGre}IP:${RCol} ${myip}${Cya}
  .... .y.}                  '.._-:'_...jf     
  g-.  .Lg'                 ..,..'-....,'.
 .'.   .Y^                  .....',].._f
 ......-f.                 .-,,.,.-:--&'       ${BGre}Storage:${RCol}${Cya} 
                           .'...'..'_J'        ${RCol}${mydev1}${Cya}
                           .~......'#'         ${RCol}${mydev2}${Cya}
                           '..,,.,_]'          ${RCol}${mydev3}${Cya}
                           .L..'..''.          ${RCol}${mydev4}${Cya}
${RCol}"
