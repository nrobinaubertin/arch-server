#!/bin/bash
# speed transfer snapshot

duration=2
#interface="wlp3s0"
interface=$(ip route show | grep default | cut -d' ' -f5)

sys_dir="/sys/class/net/${interface}/statistics"

rxb=$(<${sys_dir}/rx_bytes)
txb=$(<${sys_dir}/tx_bytes)
sleep $duration
rxbn=$(<${sys_dir}/rx_bytes)
txbn=$(<${sys_dir}/tx_bytes)

rxdif=$(echo $((rxbn - rxb)) )
txdif=$(echo $((txbn - txb)) )

rxdif=$((rxdif / duration))
txdif=$((txdif / duration))

rx_unit="B"
tx_unit="B"
if (( $rxdif > 2048 ))
then
    rxdif=$((rxdif / 1024))
    rx_unit="KB"
    
    if (( $rxdif > 2048 ))
    then
        rxdif=$((rxdif / 1024))
        rx_unit="MB"
    fi
fi
if (( $txdif > 2048 ))
then
    txdif=$((txdif / 1024))
    tx_unit="KB"
    
    if (( $txdif > 2048 ))
    then
        txdif=$((txdif / 1024))
        tx_unit="MB"
    fi
fi
echo -e "$rxdif$rx_unit $txdif$tx_unit"
